[supervisord]
nodaemon=true
user=ipfs_user
logfile=/tmp/supervisord.log
pidfile=/tmp/supervisord.pid

[unix_http_server]
file=/tmp/supervisor.sock
chmod=0700
chown=ipfs_user:ipfs_user

[supervisorctl]
serverurl=unix:///tmp/supervisor.sock

[rpcinterface:supervisor]
supervisor.rpcinterface_factory = supervisor.rpcinterface:make_main_rpcinterface

# IPFS daemon
[program:ipfs]
command=/usr/local/bin/ipfs daemon --migrate=true --enable-gc
directory=/home/ipfs_user
user=ipfs_user
autostart=true
autorestart=true
stderr_logfile=/tmp/ipfs_kit_logs/ipfs_error.log
stdout_logfile=/tmp/ipfs_kit_logs/ipfs_out.log
environment=IPFS_PATH="/home/ipfs_user/.ipfs"

# IPFS Cluster service (optional)
[program:ipfs-cluster]
command=/usr/local/bin/ipfs-cluster-service daemon
directory=/home/ipfs_user
user=ipfs_user
autostart=false
autorestart=true
stderr_logfile=/tmp/ipfs_kit_logs/cluster_error.log
stdout_logfile=/tmp/ipfs_kit_logs/cluster_out.log
environment=IPFS_CLUSTER_PATH="/home/ipfs_user/.ipfs-cluster"

# IPFS-Kit daemon
[program:ipfs-kit-daemon]
command=ipfs-kit daemon start --host 0.0.0.0 --port 9999
directory=/app
user=ipfs_user
autostart=false
autorestart=true
stderr_logfile=/tmp/ipfs_kit_logs/daemon_error.log
stdout_logfile=/tmp/ipfs_kit_logs/daemon_out.log
environment=PYTHONPATH="/app",IPFS_KIT_AUTO_INSTALL_DEPS="0",IPFS_KIT_AUTO_INSTALL_LOTUS_DEPS="0"

# MCP server (optional)
[program:mcp-server]
command=python -m mcp.ipfs_kit.modular_enhanced_mcp_server --host 0.0.0.0 --port 8000
directory=/app
user=ipfs_user
autostart=false
autorestart=true
stderr_logfile=/tmp/ipfs_kit_logs/mcp_error.log
stdout_logfile=/tmp/ipfs_kit_logs/mcp_out.log
environment=PYTHONPATH="/app"
