[supervisord]
nodaemon=true
user=ipfs_user
logfile=/app/logs/supervisord.log
pidfile=/tmp/supervisord.pid
childlogdir=/app/logs

[program:ipfs-daemon]
command=/usr/local/bin/ipfs daemon --migrate=true --enable-gc
directory=/home/ipfs_user
user=ipfs_user
autostart=true
autorestart=true
stdout_logfile=/app/logs/ipfs-daemon.log
stderr_logfile=/app/logs/ipfs-daemon-error.log
environment=IPFS_PATH="/home/ipfs_user/.ipfs"
priority=10

[program:ipfs-cluster-service]
command=/usr/local/bin/ipfs-cluster-service daemon
directory=/home/ipfs_user
user=ipfs_user
autostart=true
autorestart=true
stdout_logfile=/app/logs/ipfs-cluster-service.log
stderr_logfile=/app/logs/ipfs-cluster-service-error.log
environment=IPFS_CLUSTER_PATH="/home/ipfs_user/.ipfs-cluster"
priority=20
startretries=10
startsecs=5

[program:ipfs-kit-daemon]
command=/usr/local/bin/python3 -m uvicorn ipfs_kit_py.daemon:app --host 0.0.0.0 --port 9999
directory=/app
user=ipfs_user
autostart=true
autorestart=true
stdout_logfile=/app/logs/ipfs-kit-daemon.log
stderr_logfile=/app/logs/ipfs-kit-daemon-error.log
priority=30
startretries=10
startsecs=5

[group:ipfs-services]
programs=ipfs-daemon,ipfs-cluster-service,ipfs-kit-daemon
priority=999
