[pytest]

# Basic options
addopts = -q --strict-markers -ra --tb=short

# Markers
markers = 
    integration: marks tests as integration (deselect with '-m "not integration"')
    unit: Unit tests
    slow: Slow running tests
    requires_network: Tests requiring network access
    timeout: per-test timeout marker (pytest-timeout)

# Test discovery
testpaths = tests
python_files = test_*.py
python_functions = test_*
python_classes = Test*

# Python path
pythonpath = .

# Async configuration - using anyio for better compatibility
anyio_mode = auto

# pytest-asyncio: silence deprecation by setting default loop scope
asyncio_default_fixture_loop_scope = function

# Warnings
filterwarnings = ignore::DeprecationWarning
    ignore:coroutine 'WasmModuleRegistry.register_module' was never awaited:RuntimeWarning
    ignore:coroutine 'WasmModuleRegistry.get_module' was never awaited:RuntimeWarning
    ignore:Can't initialize NVML:UserWarning

# Ignore integration directory requiring external services
norecursedirs = tests/integration tests/archived_stale_tests

# Minimum Python version
minversion = 3.8
