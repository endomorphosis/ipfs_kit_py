{
  "version": "2.0.0",
  "tasks": [
    {
      "label": "GitHub: List Workflow Runs (Cached)",
      "type": "shell",
      "command": "bash",
      "args": ["-lc", "source .github/scripts/gh_cache_wrapper.sh && gh run list --limit 10"],
      "problemMatcher": [],
      "presentation": { "reveal": "always", "panel": "dedicated" },
      "group": "none"
    },
    {
      "label": "GitHub: View Recent Failures (Cached)",
      "type": "shell",
      "command": "bash",
      "args": ["-lc", "source .github/scripts/gh_cache_wrapper.sh && gh run list --status failure --limit 5"],
      "problemMatcher": [],
      "presentation": { "reveal": "always", "panel": "dedicated" },
      "group": "none"
    },
    {
      "label": "GitHub: List PRs (Cached)",
      "type": "shell",
      "command": "bash",
      "args": ["-lc", "source .github/scripts/gh_cache_wrapper.sh && gh pr list --state all --limit 20"],
      "problemMatcher": [],
      "presentation": { "reveal": "always", "panel": "dedicated" },
      "group": "none"
    },
    {
      "label": "GitHub: List Open Issues (Cached)",
      "type": "shell",
      "command": "bash",
      "args": ["-lc", "source .github/scripts/gh_cache_wrapper.sh && gh issue list --state open --limit 20"],
      "problemMatcher": [],
      "presentation": { "reveal": "always", "panel": "dedicated" },
      "group": "none"
    },
    {
      "label": "GitHub: Show Cache Statistics",
      "type": "shell",
      "command": "bash",
      "args": ["-lc", "source .github/scripts/gh_cache_wrapper.sh && gh_cache_stats"],
      "problemMatcher": [],
      "presentation": { "reveal": "always", "panel": "dedicated" },
      "group": "none"
    },
    {
      "label": "GitHub: Clear Cache",
      "type": "shell",
      "command": "bash",
      "args": ["-lc", "source .github/scripts/gh_cache_wrapper.sh && gh_cache_clear"],
      "problemMatcher": [],
      "presentation": { "reveal": "always", "panel": "dedicated" },
      "group": "none"
    },
    {
      "label": "Cache: Test GitHub CLI Caching",
      "type": "shell",
      "command": "bash",
      "args": [
        "-lc",
        "source .github/scripts/gh_cache_wrapper.sh && export GH_CACHE_ENABLED=1 && echo '=== First call (miss) ===' && gh repo view && echo $'\\n=== Second call (hit) ===' && gh repo view && echo $'\\n=== Statistics ===' && gh_cache_stats"
      ],
      "problemMatcher": [],
      "presentation": { "reveal": "always", "panel": "dedicated" },
      "group": "none"
    },

    {
      "label": "Test: Run All Tests",
      "type": "shell",
      "command": "pytest",
      "args": ["tests/", "-v"],
      "problemMatcher": [],
      "presentation": { "reveal": "always", "panel": "dedicated" },
      "group": { "kind": "test", "isDefault": true }
    },
    {
      "label": "Build: Install Dependencies",
      "type": "shell",
      "command": "python",
      "args": ["-m", "pip", "install", "-r", "requirements.txt"],
      "problemMatcher": [],
      "presentation": { "reveal": "always", "panel": "dedicated" },
      "group": "build"
    },

    {
      "label": "CI/CD: Analyze Recent Workflow Failure",
      "type": "shell",
      "command": "bash",
      "args": [
        "-lc",
        "source .github/scripts/gh_cache_wrapper.sh && RUN_ID=$(gh run list --status failure --limit 1 --json databaseId --jq '.[0].databaseId') && echo \"Analyzing run: $RUN_ID\" && gh run view \"$RUN_ID\""
      ],
      "problemMatcher": [],
      "presentation": { "reveal": "always", "panel": "dedicated" },
      "group": "none"
    },

    {
      "label": "pytest-all",
      "type": "shell",
      "command": "pytest",
      "args": ["-q", "-rs", "-p", "no:warnings"],
      "problemMatcher": [],
      "group": "test"
    },
    {
      "label": "pytest-first-fail",
      "type": "shell",
      "command": "pytest",
      "args": ["-q", "-rs", "-p", "no:warnings", "--maxfail=1", "-x"],
      "problemMatcher": [],
      "group": "test"
    },
    {
      "label": "pytest-first-fail-verbose",
      "type": "shell",
      "command": "pytest",
      "args": ["-rs", "-p", "no:warnings", "--maxfail=1", "-x", "-vv"],
      "problemMatcher": [],
      "group": "test"
    },
    {
      "label": "pytest-full-first-fail-log",
      "type": "shell",
      "command": "bash",
      "args": [
        "-lc",
        "cd /home/barberb/ipfs_kit_py && source ./bin/env.sh && mkdir -p .cache && (./.venv/bin/python -m pytest -q --maxfail=1) 2>&1 | tee .cache/pytest_first_fail.log"
      ],
      "problemMatcher": [],
      "group": "test"
    },
    {
      "label": "pytest-first-fail-log",
      "type": "shell",
      "command": "bash",
      "args": [
        "-lc",
        "cd /home/barberb/ipfs_kit_py && source ./bin/env.sh && mkdir -p .cache && (./.venv/bin/python -m pytest -q --maxfail=1) 2>&1 | tee .cache/pytest_first_fail.log"
      ],
      "problemMatcher": [],
      "group": "test"
    },
    {
      "label": "pytest (quiet)",
      "type": "shell",
      "command": "pytest",
      "args": ["-q"],
      "problemMatcher": [],
      "group": "test"
    },
    {
      "label": "Run pytest",
      "type": "shell",
      "command": "pytest",
      "args": ["-q"],
      "problemMatcher": [],
      "group": "test"
    },
    {
      "label": "pytest-full",
      "type": "shell",
      "command": "bash",
      "args": ["-lc", "cd /home/barberb/ipfs_kit_py && source ./bin/env.sh && ./.venv/bin/python -m pytest -ra"],
      "problemMatcher": [],
      "group": "test"
    },
    {
      "label": "pytest maxfail1 (env.sh)",
      "type": "shell",
      "command": "bash",
      "args": ["-lc", "source ./bin/env.sh && pytest -q --maxfail=1"],
      "problemMatcher": [],
      "group": "test"
    }
  ]
}